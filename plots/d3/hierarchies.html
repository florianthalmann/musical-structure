time<!DOCTYPE html>
<meta charset="utf-8">
<svg width="1200" height="700"></svg>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script>
const YSIZE = false;
draw();
async function draw() {
  const svg = d3.select("svg")
    .style("height", 5000)
    .style("width", 2000);
  //width = +svg.attr("width"),
  //height = +svg.attr("height");
  
  const HEIGHT = 15;
  const WIDTH = 5;
  
  const tooltip = d3.select("body")
    .append("div")
    .style("position", "absolute")
    .style("z-index", "10")
    .style("visibility", "hidden")
    .style("font-size", "10px")
    .text("");
  
  //const hierarchy = [0,[[[[[1,2],[[3,4],[1,2],5],6],[7,8],9],3,10],8,11,[[[[1,2],[[3,4],[1,2],5],6],[7,8],9],3,10],8,11],[[[[[1,2],[[3,4],[1,2],5],6],[7,8],9],3,10],8,11,[[[[1,2],[[3,4],[1,2],5],6],[7,8],9],3,10],8,11],[1,2],[[[[3,4],[1,2],5],[7,8]],2],[3,4],8,2,[[[[[3,4],[1,2],5],[7,8]],2],[[[[3,4],[1,2],5],[7,8]],2]],[[[[[3,4],[1,2],5],[7,8]],2],[[[[3,4],[1,2],5],[7,8]],2]],[[[[[3,4],[1,2],5],[7,8]],2],[[[[3,4],[1,2],5],[7,8]],2]],[3,4],12]
  //const hierarchy = [0,[1,2],[1,2],[1,2],[1,2],[1,2],1,3,[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],4];
  //const hierarchy = [0,1,[[[2,3],[2,3],4],2,5],[[[2,3],[2,3],4],2,5],2,1,6];
  const hierarchy =
  //china doll 1
  //[0,0,[1,1,2,2,2,3,3,3,3],4,4,4,4,4,4,4,4,5,[[1,1,2,2,2,3,3,3,3],6,6,6,6],[[7,8,8,8],5],[[1,1,2,2,2,3,3,3,3],6,6,6,6],[[[[7,8,8,8],5],9,9],2,2,2,10,10,10,10,10,10,10,10],[[[[7,8,8,8],5],9,9],2,2,2,10,10,10,10,10,10,10,10],[[[[7,8,8,8],5],9,9],2,2,2,10,10,10,10,10,10,10,10],7,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,14,14,14,15,14,14,14,16,17,18,18,18,17,19,19,19,19,19,19,19,19]
  //china doll 2
  //[0,0,[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]
  //china doll 3
  //[0,0,[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,[4,5,5,5],[4,5,5,5],[4,5,5,5],[4,5,5,5],[4,5,5,5],[4,5,5,5],[4,5,5,5],[4,5,5,5],[4,5,5,5],[4,5,5,5],[4,5,5,5],[4,5,5,5],4]
  //box of rain 1
  //[0,0,0,0,[1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],[1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]
  //box of rain 2
  //[0,0,0,0,[[[[[[[1,[2,2,2,2,2,2,3],4,4,4,4,4],5,5,5,5,5,5],[6,7,7]],[1,[2,2,2,2,2,2,3],4,4,4,4,4],8,8,8,8,8,8,8],[6,7,7],9,9],[2,2,2,2,2,2,3],10,10,10,10,10,10,10,10],7,7],[[[[[[[1,[2,2,2,2,2,2,3],4,4,4,4,4],5,5,5,5,5,5],[6,7,7]],[1,[2,2,2,2,2,2,3],4,4,4,4,4],8,8,8,8,8,8,8],[6,7,7],9,9],[2,2,2,2,2,2,3],10,10,10,10,10,10,10,10],7,7],1,2,2,2,2,2,2,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11]
  //box of rain 3
  //[0,0,0,0,0,[[[[[1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3],4,4,4,5,5],1,1,1,1,1,6,6,6,6,6,6,6,6,6,6],4,4,4],[[[[[1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3],4,4,4,5,5],1,1,1,1,1,6,6,6,6,6,6,6,6,6,6],4,4,4],1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7]
  //box of rain 4
  //[0,0,0,0,1,[[[2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],4,4],2,2,2,2,2,5,5,5,5,5,5,5,5,5,5,5,5,5],[[[2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],4,4],2,2,2,2,2,5,5,5,5,5,5,5,5,5,5,5,5,5],2,2,2,2,2,1,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6]
  //china cat sunflower 1
  //[0,0,0,0,0,0,0,0,[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],1]
  //cosmic charlie 1
  //[0,[1,0],[1,0],[[1,0],2,2,2],3,3,3,3,3,4,5,[[[[[6,6,6,6,6,7,8],9],10,11,11,11],[[1,0],2,2,2],12,12,12,12,12],4,13],[[[[[6,6,6,6,6,7,8],9],10,11,11,11],[[1,0],2,2,2],12,12,12,12,12],4,13],[[[[[6,6,6,6,6,7,8],9],10,11,11,11],[[1,0],2,2,2],12,12,12,12,12],4,13],[6,6,6,6,6,7,8],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],[14,15],14]
  //casey jones 1
  //[0,0,0,[[1,[2,2,3]],4,4,4,4,4,4,4,4,4,4,4,4,4,4],[[1,[2,2,3]],4,4,4,4,4,4,4,4,4,4,4,4,4,4],[[1,[2,2,3]],4,4,4,4,4,4,4,4,4,4,4,4,4,4],[[1,[2,2,3]],4,4,4,4,4,4,4,4,4,4,4,4,4,4],[1,[2,2,3]],5,5,5,5,5,5,5,6,7,7,8,6,[9,10,10],11,11,[2,2,3],12,12,12,[13,[14,14,8]],15,[[[9,10,10],[13,[14,14,8]]],3],[[[9,10,10],[13,[14,14,8]]],3],[[[9,10,10],[13,[14,14,8]]],3],9,16,16,16,[14,14,8],3,17,17,17,17,17,17,17,17,17,17,17,17,17,17]
  //casey jones 2
  //[0,0,0,[[[[[1,2],[[3,4],[1,2],5],6,6],[7,8],9],3,10],8,11,11,11],[[[[[1,2],[[3,4],[1,2],5],6,6],[7,8],9],3,10],8,11,11,11],[[[[[1,2],[[3,4],[1,2],5],6,6],[7,8],9],3,10],8,11,11,11],[[[[[1,2],[[3,4],[1,2],5],6,6],[7,8],9],3,10],8,11,11,11],[1,2],[[[[[3,4],[1,2],5],[7,8]],2],[3,4]],8,2,[[[[3,4],[1,2],5],[7,8]],2],[[[[3,4],[1,2],5],[7,8]],2],[[[[3,4],[1,2],5],[7,8]],2],[[[[3,4],[1,2],5],[7,8]],2],[[[[3,4],[1,2],5],[7,8]],2],[[[[[3,4],[1,2],5],[7,8]],2],[3,4]],12,12,12,12,12,12,12,12,12,12,12,12,12,12]
  //casey jones 3
  //[0,0,0,[[[[[[1,2,2],3],[[[1,2,2],3],4]],3],[[1,2,2],3]],[[1,2,2],3]],[[[[[[1,2,2],3],[[[1,2,2],3],4]],3],[[1,2,2],3]],[[1,2,2],3]],[[[[[[1,2,2],3],[[[1,2,2],3],4]],3],[[1,2,2],3]],[[1,2,2],3]],[[[[[[1,2,2],3],[[[1,2,2],3],4]],3],[[1,2,2],3]],[[1,2,2],3]],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],[[1,2,2],3],1,5,5,5,5,5,5,5,5,5,5,5,5,5]
  //cumberland blues
  //[0,[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[[3,2],4,5],[[3,2],4,5],[[3,2],4,5],[3,2],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[[4,6],7,7],[[4,6],7,7],[[4,6],7,7],[[4,6],7,7],[4,6],[4,6],[4,6],[4,6],[4,6]]
  //cumberland blues msa only
  //[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,6,6,5,5,7,7,7,5,5,7,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,5,5,0,10,6,5,6,5,0,5,6,5,0,5,6,5,0,0,0,0,0,0,0,0,11]
  //[[[[[[[[[[[[[[[[[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,1]]]]]]]]]]]]]]]]]]]]]]],2,3],0],0],0],0],0],0],0],0],0],0],0],0],0],0],0],0,[[[[[[[[[[[[[[[[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,1]]]]]]]]]]]]]]]]]]]]]]],2,3],0],0],0],0],0],0],0],0],0],0],0],0],0],0],0],4,4,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,5]]]]]]]]]]]]]]]]]]]]]],5,6,[6,5],[5,7],7,7,5,[5,7],8,9,0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,[0,5]]]]]]]]]]]]]]]]]]]]]],[0,5],5,0,10,[6,5],[[6,5],[0,5]],[[6,5],[0,5]],[6,5],0,0,0,0,0,0,0,0,11]
  //[[[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[0,0],[0,0]],[[0,0],[0,0]]],1,2,3],[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[0,0],[0,0]],[[0,0],[0,0]]],1,2,3],[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[0,0]],0,4,4,[[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[0,0],[0,0]],[0,0]]],[5,5],6,[6,5],5,7,7,7,[5,5],7,8,9,[[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[0,0],[0,0]],[0,0]]],[0,5],[0,5],5,0,10,[6,5],[[6,5],[0,5]],[[6,5],[0,5]],[6,5],[[[0,0],[0,0]],[[0,0],[0,0]]],11]
  //[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],0,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],4,4,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],5,6,13,[5,7],7,7,5,[5,7],8,9,0,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],12,5,0,10,13,[6,5,12],[6,5,12],13,0,0,0,0,0,0,0,0,11]
  //[0,0,[1,2],[1,1,2,2,1,1,2,2,2,2,3,1,4,2,3,5,4,2],[1,1,2,2,1,1,2,2,2,2,3,1,4,2,3,5,4,2],[1,1,2,2,1,1,2,2,2,2,3,1,4,2,3,5,4,2],[1,1,2,2,1,1,2,2,2,2,3,1,4,2,3,5,4,2],[1,1,2,2,1,1,2,2,1,1,1,2],[1,1,2,2,1,1,2,2,1,1,1,2],[1,1,2,2,1,1,1,2],[1,1,2,2,1,1,1,2],[1,1,2,2],[1,1,2,2,1,1,2,2,1,1,1,2],[1,1,2,2],6,[1,1,2],7,3,4,[4,2],2,2,2,2,2,2,2,8]
  //[0,0,[1,2],[[[[[[[[1,[1,2]],2],[[[1,[1,2]],2],2]],2],3,1],[4,2]],3,5],[4,2]],[[[[[[[[1,[1,2]],2],[[[1,[1,2]],2],2]],2],3,1],[4,2]],3,5],[4,2]],[[[[[[[[1,[1,2]],2],[[[1,[1,2]],2],2]],2],3,1],[4,2]],3,5],[4,2]],[[[[[[[[1,[1,2]],2],[[[1,[1,2]],2],2]],2],3,1],[4,2]],3,5],[4,2]],[[[1,[1,2]],2],[[[[1,[1,2]],2],1],[1,[1,2]]]],[[[1,[1,2]],2],[[[[1,[1,2]],2],1],[1,[1,2]]]],[[[[1,[1,2]],2],1],[1,[1,2]]],[[[[1,[1,2]],2],1],[1,[1,2]]],[[1,[1,2]],2],[[[1,[1,2]],2],[[[[1,[1,2]],2],1],[1,[1,2]]]],[[1,[1,2]],2],6,[1,[1,2]],7,3,4,[4,2],2,2,2,2,2,2,2,8]
  //[0,0,[1,2],[[[[[[[[[1,[1,2]],2],[[[1,[1,2]],2],2]],2],3],1],[4,2]],3,5],[4,2]],[[[[[[[[[1,[1,2]],2],[[[1,[1,2]],2],2]],2],3],1],[4,2]],3,5],[4,2]],[[[[[[[[[1,[1,2]],2],[[[1,[1,2]],2],2]],2],3],1],[4,2]],3,5],[4,2]],[[[[[[[[[1,[1,2]],2],[[[1,[1,2]],2],2]],2],3],1],[4,2]],3,5],[4,2]],[[[1,[1,2]],2],[[[[1,[1,2]],2],1],[1,[1,2]]]],[[[1,[1,2]],2],[[[[1,[1,2]],2],1],[1,[1,2]]]],[[[[1,[1,2]],2],1],[1,[1,2]]],[[[[1,[1,2]],2],1],[1,[1,2]]],[[1,[1,2]],2],[[[1,[1,2]],2],[[[[1,[1,2]],2],1],[1,[1,2]]]],[[1,[1,2]],2],6,[1,[1,2]],7,3,4,[4,2],2,2,2,2,2,2,2,8]
  //[0,0,[1,2],[[[[[1,[1,2]],2],[[[1,[1,2]],2],2],2,3,1],[4,2],3,5],[4,2]],[[[[[1,[1,2]],2],[[[1,[1,2]],2],2],2,3,1],[4,2],3,5],[4,2]],[[[[[1,[1,2]],2],[[[1,[1,2]],2],2],2,3,1],[4,2],3,5],[4,2]],[[[[[1,[1,2]],2],[[[1,[1,2]],2],2],2,3,1],[4,2],3,5],[4,2]],[[[1,[1,2]],2],[[[[1,[1,2]],2],1],[1,[1,2]]]],[[[1,[1,2]],2],[[[[1,[1,2]],2],1],[1,[1,2]]]],[[[[1,[1,2]],2],1],[1,[1,2]]],[[[[1,[1,2]],2],1],[1,[1,2]]],[[1,[1,2]],2],[[[1,[1,2]],2],[[[[1,[1,2]],2],1],[1,[1,2]]]],[[1,[1,2]],2],6,[1,[1,2]],7,3,4,[4,2],2,2,2,2,2,2,2,8]
  //[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],0,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],4,4,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[0,5]],5,6,[6,5],[5,7],7,7,5,[5,7],8,9,0,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[0,5]],[0,5],5,0,10,[6,5],[[6,5],[0,5]],[[6,5],[0,5]],[6,5],0,0,0,0,0,0,0,0,11]
  //[0,0,[1,2],[[[1,[1,2]],2],[[1,[1,2]],2],2,2,3,1,[4,2],3,5,[4,2]],[[[1,[1,2]],2],[[1,[1,2]],2],2,2,3,1,[4,2],3,5,[4,2]],[[[1,[1,2]],2],[[1,[1,2]],2],2,2,3,1,[4,2],3,5,[4,2]],[[[1,[1,2]],2],[[1,[1,2]],2],2,2,3,1,[4,2],3,5,[4,2]],[[[1,[1,2]],2],[[[1,[1,2]],2],1,[1,[1,2]]]],[[[1,[1,2]],2],[[[1,[1,2]],2],1,[1,[1,2]]]],[[[1,[1,2]],2],1,[1,[1,2]]],[[[1,[1,2]],2],1,[1,[1,2]]],[[1,[1,2]],2],[[[1,[1,2]],2],[[[1,[1,2]],2],1,[1,[1,2]]]],[[1,[1,2]],2],6,[1,[1,2]],7,3,4,[4,2],2,2,2,2,2,2,2,8]
  //[0,0,1,[[[2,[[1,1],[2,2]]],[[1,1],[2,2]]],[2,2],3,1,4,2,3,5,4,[[2,[[1,1],[2,2]]],[[1,1],[2,2]]],[2,2],3,1,4,2,3,5,4],[[[2,[[1,1],[2,2]]],[[1,1],[2,2]]],[2,2],3,1,4,2,3,5,4,[[2,[[1,1],[2,2]]],[[1,1],[2,2]]],[2,2],3,1,4,2,3,5,4],[[2,[[1,1],[2,2]]],[[1,1],[2,2]]],[[[1,1],1],[[2,[[1,1],[2,2]]],[[1,1],[2,2]]]],[[[1,1],1],[2,[[1,1],[2,2]]]],[[[1,1],1],[2,[[1,1],[2,2]]]],[[[1,1],1],[[2,[[1,1],[2,2]]],[[1,1],[2,2]]]],[[1,1],[2,2]],[[[1,1],1],[2,[[1,1],[2,2]]]],6,[1,1],2,7,3,4,4,[[2,2],[2,2]],[[2,2],[2,2]],8]
  //[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],0,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],4,4,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[0,5]],5,6,[6,5],[5,7],7,7,5,[5,7],8,9,0,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,[0,5]],[0,5],5,0,10,[6,5],[[6,5],[0,5]],[[6,5],[0,5]],[6,5],0,0,0,0,0,0,0,0,11]
  //[[[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[0,0],[0,0]],[[0,0],[0,0]]],1,2,3],[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[0,0],[0,0]],[[0,0],[0,0]]],1,2,3],[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[0,0]],0,4,4,[[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[0,0],[0,0]],[0,0]]],[5,5],6,[6,5],5,7,7,7,[5,5],7,8,9,[[[[[0,0],[0,0]],[[0,0],[0,0]]],[[[0,0],[0,0]],[[0,0],[0,0]]]],[[[0,0],[0,0]],[0,0]]],[0,5],[0,5],5,0,10,[6,5],[[6,5],[0,5]],[[6,5],[0,5]],[6,5],[[[0,0],[0,0]],[[0,0],[0,0]]],11]
  //[0,[1,2],[[[1,2],2,[2,[2,3]]],[4,1],[[5,[6,[6,3]],[4,1]],6],[[2,[2,3]],[6,[4,1]],3]],5,3,[3,[6,[6,3]],[3,1]],[5,[6,[6,3]],[4,1]],1,[[2,[2,3]],[6,[4,1]],3],[3,4,5,[6,3],[3,6,[6,[4,1]]],5,[2,3],[3,6,[6,[4,1]]],[6,3]],[[[1,2],2,[2,[2,3]]],[4,1],[[5,[6,[6,3]],[4,1]],6],[[2,[2,3]],[6,[4,1]],3]],[3,1],[3,[6,[6,3]],[3,1]],[[5,[6,[6,3]],[4,1]],6],[6,[2,3]],6,6,4,3,[3,4,5,[6,3],[3,6,[6,[4,1]]],5,[2,3],[3,6,[6,[4,1]]],[6,3]],[[1,2],2,[2,[2,3]]],1,1,6,6,6,[6,[2,3]],1,[6,3],1,0,0,3,3,2,2,2,2,1]
  //[0,1,2,1,[[[2,2],[[2,2],3]],[[4,1],5],[[6,6],3,[4,1]],6,[[[2,2],3],6,[4,1]]],3,5,[[3,3],[6,6]],[[[3,3],1],5,[[6,6],3,[4,1]]],1,[[[2,2],3],6,[4,1]],[[3,3],4,5,6,[[3,3],[6,6]],[[4,1],5],2,[[3,3],[6,6]],[4,1],[6,[3,1]]],[[[2,2],[[2,2],3]],[[4,1],5],[[6,6],3,[4,1]],6,[[[2,2],3],6,[4,1]]],[[3,3],1],[3,[6,6]],[[[3,3],1],5,[[6,6],3,[4,1]]],[[6,6],2],[3,[6,6]],4,[[3,3],4,5,6,[[3,3],[6,6]],[[4,1],5],2,[[3,3],[6,6]],[4,1],[6,[3,1]]],[[2,2],[[2,2],3]],1,1,[6,6],[[6,6],2],[3,1],[6,[3,1]],0,0,[3,3],[2,2],[2,2],1]
  //[0,0,0,1,1,1,1,1,2,2,[3,3,3,3,3,4,4,4,4,4,4,4,5,5,5],6,[7,[8,8,8,2,2]],[3,3,3,3,3,4,4,4,4,4,4,4,5,5,5],[7,[8,8,8,2,2]],[9,9,4,4,4,4,4,4,4,10,10,10,10,10,1,1,1,1,1],11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,6,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,[8,8,8,2,2],[9,9,4,4,4,4,4,4,4,10,10,10,10,10,1,1,1,1,1],13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13]
  //[0,0,0,[1,1,1,1,1,[[2,2,3,3,3,3],4,5,5,5,5,5,5,5,6,6,6],7,7,8,8,8,[[2,2,3,3,3,3],4,5,5,5,5,5,5,5,6,6,6],9,8,8,8,2,2,10,10,5,5,5,5,5,5,5,11,11,11,11,11],[1,1,1,1,1,[[2,2,3,3,3,3],4,5,5,5,5,5,5,5,6,6,6],7,7,8,8,8,[[2,2,3,3,3,3],4,5,5,5,5,5,5,5,6,6,6],9,8,8,8,2,2,10,10,5,5,5,5,5,5,5,11,11,11,11,11],1,1,1,1,1,[2,2,3,3,3,3],12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12]
  //[0,[[[[1,1,1,1,1,1,2,2,2,2,3,3,3,3,3],4],5],1,1,1,1,1,1,6,6,6],[[[1,1,1,1,1,1,2,2,2,2,3,3,3,3,3],4],5],[[[[1,1,1,1,1,1,2,2,2,2,3,3,3,3,3],4],5],1,1,1,1,1,1,6,6,6],[1,1,1,1,1,1,2,2,2,2,3,3,3,3,3],7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,3,3,3,3,3,4,5,[[1,1,1,1,1,1,2,2,2,2,3,3,3,3,3],4],8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]
  //[0,[[[[1,1,1,1,1,2],3,3,3,3,3,3,3,3,3],[4,5]],[1,1,1,1,1,2],6,6,6],[[[1,1,1,1,1,2],3,3,3,3,3,3,3,3,3],[4,5]],[[[[1,1,1,1,1,2],3,3,3,3,3,3,3,3,3],[4,5]],[1,1,1,1,1,2],6,6,6],[[1,1,1,1,1,2],3,3,3,3,3,3,3,3,3],7,7,[[[1,1,1,1,1,2],3,3,3,3,3,3,3,3,3],[4,5]],1,1,1,1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,[4,5],9,9,9,9,9,2,3,3,3,3,3,3,3,3,3,4,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10]
  //[0,[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[4,4,4,4,4,5,5],[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],4,4,4,4,4,6,6,[4,4,4,4,4,5,5],1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,[4,4,4,4,4,5,5],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]
  //[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,[2,2,2,2,2,2,2,2,2,2,2,2,2,2,[3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,[3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],4,4,4,5,5,5,5,5,5,5,5,5,5,5,[3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],4,4,4,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6]
  //[0,[1,[[[[2,1],[2,1]],[[2,1],[2,1]]],[[[2,1],[2,1]],[[2,1],[2,1]]]]],[[[2,1],[2,1]],[2,1]],3,3,3,[[[[2,1],[2,1]],[[2,1],[2,1]]],[[[2,1],[2,1]],[[2,1],[2,1]]]],[[[[2,1],[2,1]],[[2,1],[2,1]]],[[[2,1],[2,1]],[[2,1],[2,1]]]],[[[2,1],[2,1]],[[2,1],[2,1]]],3,3,3,[[[2,1],[2,1]],[[2,1],[2,1]]],[[[2,1],[2,1]],[2,1]],2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,[1,[[[[2,1],[2,1]],[[2,1],[2,1]]],[[[2,1],[2,1]],[[2,1],[2,1]]]]],5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5]
  //[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,2,2,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,5,5,5,5,5,5,5,[6,7],[6,7],[6,7],[6,7],6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,[10,10,10,11],[10,10,10,11],10,10,10,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16]
  [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,[1,1,2,2,2,2,2,2,[3,4]],5,6,[5,7],[5,7],[5,7],[5,7],[5,7],[5,7],[5,7],[5,7],[5,7],[5,7],[5,7],8,8,8,8,8,8,8,8,8,[1,1,2,2,2,2,2,2,[3,4]],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],3,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,[[10,11],12,12],[[10,11],12,12],[10,11],[10,11],13,11,[13,14],[13,14],[13,14],[13,14],[13,14],13,15,14,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]
  
  let leaves = [];
  const searchLeaves = (h,l) => Array.isArray(h) ? h.forEach(s => searchLeaves(s,l+1)) : leaves.push([h,l]);
  searchLeaves(hierarchy, 0);
  let branches = [];
  const searchBranches = (h,l) => Array.isArray(h) ? h.forEach(s => searchBranches(s,l+1)) : branches.push([h,l]);

  const rect = svg.append("g")
    .selectAll("rect")
    .data(leaves)
    .enter().append("rect")
      .attr("x", (s,i) => i*WIDTH)
      .attr("y", (s,i) => s[1]*HEIGHT)
      .attr("width", WIDTH)
      .attr("height", HEIGHT)
      .attr("fill", s => d3.hsl((s[0]+400)*30, 0.7, 0.5))
      //.attr("fill", e => d3.hsl((e.time+400)*40, 0.7, 0.5))
      .attr("opacity", n => 1)//n.version % 2 ? 0.5 : 1)
      .on("mouseover", n => { tooltip.style("visibility", "visible"); tooltip.text(n.point) })
      .on("mousemove", () => tooltip.style("top", (event.pageY-10)+"px").style("left",(event.pageX+10)+"px"))
      .on("mouseout", () => tooltip.style("visibility", "hidden"))
      .on("click", play)
  
  /*const rect = svg.append("g")
    .selectAll("rect")
    .data(leaves)
    .append("line")
    .attr("class", EDGE_LINE)
    .style("stroke", d => this.getHsl(d.target))
    .style("opacity", 0.1)
    .style("stroke-width", 3)
    //get initial values from animated svg, beautiful hack!
    /*.attr("x1", d => nodes.filter((c, i) => c == d.source)[0][0].cx.baseVal.value)
    .attr("y1", d => nodes.filter((c, i) => c == d.source)[0][0].cy.baseVal.value)
    .attr("x2", d => nodes.filter((c, i) => c == d.target)[0][0].cx.baseVal.value)
    .attr("y2", d => nodes.filter((c, i) => c == d.target)[0][0].cy.baseVal.value)*/
    /*.transition()
      .duration(this.transitionDuration)
      .attr("x1", d => this.getX(d.source))
      .attr("y1", d => this.getY(d.source))
      .attr("x2", d => this.getX(d.target))
      .attr("y2", d => this.getY(d.target));*/
  
  function play(segment) {
    console.log(segment)
    //const path = segment.path.replace("/Users/flo/Projects/Code/FAST/musical-structure/", "")
    const path = segment.path.replace("/Volumes/FastSSD/", "http://localhost:3001/")
    console.log(path)
    const audio = new Audio(path);
    audio.currentTime = segment.start;
    audio.play();
    setTimeout(() => audio.pause(), segment.duration*1000);
  }
}
</script>
